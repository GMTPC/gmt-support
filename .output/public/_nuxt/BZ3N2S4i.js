import{_}from"./D1NlPZts.js";import{Q as q,r as g,S as L,o as u,h as T,a as o,w as e,b as d,V as n,u as c,aL as y,d as p,f as l,c as k,t as $,M as b,H as C}from"./BX3DXnrd.js";import{u as Q,V as G,M as J}from"./Bf51ydsQ.js";import{a as S,V as E}from"./Dcv5vhZ4.js";import{V as P,a as B,c as K,e as O}from"./CEv2fZCT.js";import{V as w}from"./DDt4p3us.js";import{V as M}from"./C5ymIkpE.js";import{V as W}from"./EPK2GDdA.js";import{V as X}from"./CvUfA5vN.js";import{V as Z}from"./CT0Nqr-g.js";import{V as h}from"./BrBP5ZB7.js";import"./CRzN-RqF.js";/* empty css        */import"./Blmqt2wm.js";import"./DSgduqRd.js";import"./BudtlS_C.js";import"./1Ywhgt5G.js";import"./BFwkMqJ3.js";import"./DWGaNmQL.js";import"./DScwcNyu.js";import"./DWYXe89p.js";import"./CZXLAAch.js";import"./8gBy0bTw.js";import"./B2HVLM-N.js";import"./kQPmhJOm.js";import"./Dc67yaJp.js";import"./DEKsWHAV.js";import"./DbEpRz5l.js";const tt={class:"d-flex justify-space-between align-center mb-4"},et={key:0,class:"text-center py-16"},ot={class:"d-flex gap-1"},Bt=q({__name:"index",setup(rt){const m=Q(),D=g(),v=g(!1),z=g(""),f=g({show:!1,message:"",color:"success"}),F=[{title:"เลขที่เอกสาร",key:"documentNumber",sortable:!0},{title:"เรื่อง",key:"subject",sortable:!0},{title:"จาก",key:"from",sortable:!0},{title:"ถึง",key:"to",sortable:!0},{title:"วันที่",key:"date",sortable:!0},{title:"วัตถุประสงค์",key:"purposes",sortable:!1},{title:"อัพเดทล่าสุด",key:"updatedAt",sortable:!0},{title:"จัดการ",key:"actions",sortable:!1,align:"center"}],N=s=>{if(!s)return"";const t=new Date(s),a=t.getDate(),r=t.getMonth()+1,i=t.getFullYear()+543;return`${a}/${r}/${i}`},A=s=>{if(!s)return"";const t=new Date(s),a=t.getDate(),r=t.getMonth()+1,i=t.getFullYear()+543,x=t.getHours().toString().padStart(2,"0"),Y=t.getMinutes().toString().padStart(2,"0");return`${a}/${r}/${i} ${x}:${Y}`},V=(s,t="success")=>{f.value={show:!0,message:s,color:t}},R=s=>{y(`/memo/${s}?mode=view`)},j=s=>{y(`/memo/${s}`)},H=async s=>{var t;try{const a=m.currentMemo.id;m.loadMemo(s),await((t=D.value)==null?void 0:t.exportToPdf()),a!==s&&a&&m.loadMemo(a),V("Export PDF สำเร็จ!","success")}catch(a){console.error("Error exporting memo:",a),V("เกิดข้อผิดพลาดในการ Export PDF","error")}},I=s=>{z.value=s,v.value=!0},U=()=>{try{m.deleteMemo(z.value),v.value=!1,V("ลบใบขอซื้อสำเร็จ","success")}catch(s){console.error("Error deleting memo:",s),V("เกิดข้อผิดพลาดในการลบ","error")}};return L(()=>{m.loadFromStorage()}),(s,t)=>{const a=_;return u(),T("div",null,[o(G,{fluid:""},{default:e(()=>[o(a,{items:[{text:"ใบขอซื้อ",icon:"bx-file"}],"show-home":!0}),o(S,null,{default:e(()=>[o(E,{cols:"12"},{default:e(()=>[d("div",tt,[t[8]||(t[8]=d("div",null,[d("h1",{class:"text-h4 font-weight-bold"}," ใบขอซื้อ (Purchase Request Memo) "),d("p",{class:"text-subtitle-1 text-medium-emphasis"}," รายการใบขอซื้อทั้งหมด ")],-1)),o(n,{color:"primary",size:"large",onClick:t[0]||(t[0]=r=>("navigateTo"in s?s.navigateTo:c(y))("/memo/create"))},{default:e(()=>[o(p,{start:""},{default:e(()=>[...t[6]||(t[6]=[l(" bx-plus ",-1)])]),_:1}),t[7]||(t[7]=l(" สร้างใบขอซื้อใหม่ ",-1))]),_:1})])]),_:1})]),_:1}),o(S,null,{default:e(()=>[o(E,{cols:"12"},{default:e(()=>[o(P,null,{default:e(()=>[o(B,null,{default:e(()=>[c(m).savedMemos.length===0?(u(),T("div",et,[o(p,{size:"80",color:"grey-lighten-1"},{default:e(()=>[...t[9]||(t[9]=[l(" bx-file ",-1)])]),_:1}),t[12]||(t[12]=d("p",{class:"text-h6 mt-4 text-medium-emphasis"}," ยังไม่มีใบขอซื้อ ",-1)),t[13]||(t[13]=d("p",{class:"text-body-2 text-medium-emphasis mb-4"}," เริ่มต้นสร้างใบขอซื้อแรกของคุณ ",-1)),o(n,{color:"primary",onClick:t[1]||(t[1]=r=>("navigateTo"in s?s.navigateTo:c(y))("/memo/create"))},{default:e(()=>[o(p,{start:""},{default:e(()=>[...t[10]||(t[10]=[l(" bx-plus ",-1)])]),_:1}),t[11]||(t[11]=l(" สร้างใบขอซื้อใหม่ ",-1))]),_:1})])):(u(),k(W,{key:1,headers:F,items:c(m).savedMemos,"items-per-page":10,class:"elevation-0"},{"item.date":e(({item:r})=>[l($(N(r.date)),1)]),"item.purposes":e(({item:r})=>[r.purposes.consider?(u(),k(w,{key:0,size:"small",color:"primary",class:"mr-1"},{default:e(()=>[...t[14]||(t[14]=[l(" พิจารณา ",-1)])]),_:1})):b("",!0),r.purposes.know?(u(),k(w,{key:1,size:"small",color:"info",class:"mr-1"},{default:e(()=>[...t[15]||(t[15]=[l(" ทราบ ",-1)])]),_:1})):b("",!0),r.purposes.issueCommand?(u(),k(w,{key:2,size:"small",color:"warning",class:"mr-1"},{default:e(()=>[...t[16]||(t[16]=[l(" ออกคำสั่ง ",-1)])]),_:1})):b("",!0),r.purposes.continue?(u(),k(w,{key:3,size:"small",color:"success",class:"mr-1"},{default:e(()=>[...t[17]||(t[17]=[l(" ดำเนินการ ",-1)])]),_:1})):b("",!0)]),"item.updatedAt":e(({item:r})=>[l($(A(r.updatedAt)),1)]),"item.actions":e(({item:r})=>[d("div",ot,[o(M,{text:"ดู",location:"top"},{activator:e(({props:i})=>[o(n,C(i,{icon:"",size:"small",variant:"text",color:"primary",onClick:x=>R(r.id)}),{default:e(()=>[o(p,{size:"20"},{default:e(()=>[...t[18]||(t[18]=[l("bx-show",-1)])]),_:1})]),_:1},16,["onClick"])]),_:2},1024),o(M,{text:"แก้ไข",location:"top"},{activator:e(({props:i})=>[o(n,C(i,{icon:"",size:"small",variant:"text",color:"info",onClick:x=>j(r.id)}),{default:e(()=>[o(p,{size:"20"},{default:e(()=>[...t[19]||(t[19]=[l("bx-edit",-1)])]),_:1})]),_:1},16,["onClick"])]),_:2},1024),o(M,{text:"Export PDF",location:"top"},{activator:e(({props:i})=>[o(n,C(i,{icon:"",size:"small",variant:"text",color:"success",onClick:x=>H(r.id)}),{default:e(()=>[o(p,{size:"20"},{default:e(()=>[...t[20]||(t[20]=[l("bxs-file-pdf",-1)])]),_:1})]),_:1},16,["onClick"])]),_:2},1024),o(M,{text:"ลบ",location:"top"},{activator:e(({props:i})=>[o(n,C(i,{icon:"",size:"small",variant:"text",color:"error",onClick:x=>I(r.id)}),{default:e(()=>[o(p,{size:"20"},{default:e(()=>[...t[21]||(t[21]=[l("bx-trash",-1)])]),_:1})]),_:1},16,["onClick"])]),_:2},1024)])]),_:1},8,["items"]))]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),o(J,{ref_key:"pdfExportRef",ref:D,memo:c(m).currentMemo},null,8,["memo"]),o(Z,{modelValue:v.value,"onUpdate:modelValue":t[3]||(t[3]=r=>v.value=r),"max-width":"400"},{default:e(()=>[o(P,null,{default:e(()=>[o(K,null,{default:e(()=>[...t[22]||(t[22]=[l("ยืนยันการลบ",-1)])]),_:1}),o(B,null,{default:e(()=>[...t[23]||(t[23]=[l(" คุณต้องการลบใบขอซื้อนี้หรือไม่? การดำเนินการนี้ไม่สามารถย้อนกลับได้ ",-1)])]),_:1}),o(O,null,{default:e(()=>[o(X),o(n,{variant:"text",onClick:t[2]||(t[2]=r=>v.value=!1)},{default:e(()=>[...t[24]||(t[24]=[l(" ยกเลิก ",-1)])]),_:1}),o(n,{color:"error",variant:"flat",onClick:U},{default:e(()=>[...t[25]||(t[25]=[l(" ลบ ",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),o(h,{modelValue:f.value.show,"onUpdate:modelValue":t[5]||(t[5]=r=>f.value.show=r),color:f.value.color,timeout:3e3},{actions:e(()=>[o(n,{variant:"text",onClick:t[4]||(t[4]=r=>f.value.show=!1)},{default:e(()=>[...t[26]||(t[26]=[l(" ปิด ",-1)])]),_:1})]),default:e(()=>[l($(f.value.message)+" ",1)]),_:1},8,["modelValue","color"])])}}});export{Bt as default};
